apiVersion: v1
kind: Service
metadata:
  name: dashboard
  namespace: {{ .Release.Namespace }}
  annotations:
    getambassador.io/config: |
      ---
      apiVersion: getambassador.io/v3alpha1
      kind:  Mapping
      name:  dashboard_rest
      hostname: "*"
      prefix: /cn2/dashboard
      rewrite: /dashboard
      service: https://dashboard.{{ .Release.Namespace }}:9090
      timeout_ms: 15000
      ---
      apiVersion: getambassador.io/v3alpha1
      kind:  Mapping
      name:  preferences_rest
      hostname: "*"
      prefix: /cn2/preferences/user
      rewrite: /preferences/user
      service: https://dashboard.{{ .Release.Namespace }}:9090
      timeout_ms: 15000
spec:
  type: ClusterIP
  selector:
    app: dashboard
  ports:
    - name: rest
      protocol: TCP
      port: 9090
      targetPort: 9090
